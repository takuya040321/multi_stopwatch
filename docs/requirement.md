# 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
Flutter製ストップウォッチアプリ（Windows デスクトップ版）

### 1.2 プロジェクトの目的
複数のタスクや作業の時間を個別に計測・管理できるストップウォッチアプリケーションを提供する。業務時間の可視化や、複数プロジェクトの作業時間管理を効率化することを目的とする。

### 1.3 対象プラットフォーム
- Windows デスクトップアプリケーション

### 1.4 開発フレームワーク
- Flutter

## 2. 機能要件

### 2.1 ストップウォッチ管理機能

#### 2.1.1 ストップウォッチの初期表示
- アプリ起動時、デフォルトで2個のストップウォッチを表示する
- 各ストップウォッチには名称入力欄、時間表示欄、操作ボタンを含む

#### 2.1.2 ストップウォッチの追加・削除
- 画面上部に固定された追加ボタンから、ストップウォッチを追加できる
- 最大10個まで追加可能
- 最小個数は2個（削除できるのは追加した分のみ）
- 削除操作は即座に実行され、確認ダイアログは表示しない
- 削除すると、そのストップウォッチの計測データも完全に消去される

#### 2.1.3 ストップウォッチの名称設定
- 各ストップウォッチにユーザーが任意の名称を入力できる
- 名称が空欄の場合、デフォルト名称（「ストップウォッチ1」「ストップウォッチ2」など）を自動表示する
- 名称はいつでも編集可能

### 2.2 時間計測機能

#### 2.2.1 時間表示形式
- メイン表示：`HH:MM`形式（時:分）
  - 例：`01:30`（1時間30分）
- サブ表示：0.25単位での小数表記
  - 例：30分 → `0.5`、1時間30分 → `1.5`、10時間15分 → `10.25`
  - 四捨五入により算出
  - 小数点以下の桁数は必要最小限（`0.5`、`1.5`など）

#### 2.2.2 計測操作
- 各ストップウォッチに以下のボタンを配置
  - 開始/停止ボタン：計測の開始と停止を切り替える
  - リセットボタン：計測時間を0にリセットする

#### 2.2.3 計測モード
- **デフォルトモード（単一計測）**
  - 1つのストップウォッチのみ計測可能
  - あるストップウォッチが計測中に別のストップウォッチを開始すると、先に計測していたストップウォッチは自動停止する
- **複数同時計測モード**
  - 設定から有効化可能
  - 複数のストップウォッチを同時に計測できる

#### 2.2.4 自動停止機能
- 設定した時刻に到達すると、計測中のすべてのストップウォッチが自動的に停止する
- 自動停止時刻は最大5つまで設定可能
- 各自動停止時刻は個別にON/OFFを切り替え可能
- 自動停止後は手動で再開するまで停止状態を維持
- 停止した時刻は記録され、リセットされない
- すべてのストップウォッチに共通の設定として適用される

### 2.3 データ永続化機能

#### 2.3.1 保存されるデータ
- 各ストップウォッチの名称
- 各ストップウォッチの計測時間
- 自動停止時刻の設定（時刻および有効/無効状態）
- ウィンドウサイズ
- 表示レイアウト設定（縦スクロール/グリッド）
- 計測モード設定（単一計測/複数同時計測）

#### 2.3.2 保存タイミング
- ストップウォッチの停止ボタンを押した時
- ストップウォッチをリセットした時
- ストップウォッチの名称を変更した時
- 設定を変更した時
- アプリ終了時

#### 2.3.3 アプリ起動時の挙動
- 前回終了時のストップウォッチの状態を復元する
- 計測中だったストップウォッチは停止状態で表示される（前回停止した時刻を保持）
- ウィンドウサイズとレイアウト設定も前回の状態を復元する

### 2.4 UI/レイアウト機能

#### 2.4.1 ウィンドウ操作
- ウィンドウはリサイズ可能
- リサイズ後のウィンドウサイズは次回起動時に引き継がれる
- 最小化してもバックグラウンドで計測は継続される
- システムトレイ機能は実装しない

#### 2.4.2 レイアウト切り替え
- **縦スクロールレイアウト（デフォルト）**
  - ストップウォッチを縦に並べて表示
  - 画面に収まらない場合はスクロール可能
- **グリッドレイアウト**
  - ウィンドウサイズに応じて自動的に列数を調整
  - レスポンシブに配置を最適化
- 設定画面からレイアウトを切り替え可能

#### 2.4.3 UI構成
- **画面上部**
  - ストップウォッチ追加ボタン（固定配置）
  - 設定ボタン
- **メインエリア**
  - ストップウォッチリスト
- **各ストップウォッチの構成**
  - 名称入力欄
  - 時間表示（HH:MM形式 + 小数表記）
  - 開始/停止ボタン
  - リセットボタン
  - 削除ボタン（最小個数を下回らない場合のみ表示）

### 2.5 設定機能

#### 2.5.1 設定項目
- **計測モード設定**
  - 単一計測モード / 複数同時計測モード の切り替え
- **自動停止時刻設定**
  - 最大5つの自動停止時刻を登録
  - 各時刻の有効/無効を個別に切り替え
  - 時刻の追加・編集・削除
- **レイアウト設定**
  - 縦スクロール / グリッド の切り替え

#### 2.5.2 設定画面の表示
- 設定ボタンをクリックして設定画面を開く
- 設定画面は独立したウィンドウまたはダイアログとして表示
- 設定の変更は即座に反映される

## 3. 非機能要件

### 3.1 パフォーマンス要件
- ストップウォッチの時間更新は1秒ごとに行う
- 複数ストップウォッチが同時計測されている場合でも、UIの応答性を維持する
- バックグラウンド動作時もCPU使用率を最小限に抑える

### 3.2 ユーザビリティ要件
- 直感的に操作できるシンプルなUI
- ボタンやテキストは視認性の高いサイズで表示
- 操作に対するフィードバックを適切に提供

### 3.3 データ整合性要件
- アプリが異常終了した場合でも、最後に保存した状態を復元できる
- データ保存時のエラーを適切にハンドリングし、ユーザーに通知する

### 3.4 保守性要件
- コードは関数ベースで構成し、可読性とメンテナンス性を重視
- コメントは日本語で記述
- UIテキストは日本語で表示

### 3.5 拡張性要件
- 将来的な機能追加（エクスポート機能、レポート機能など）を考慮した設計
- 設定項目の追加が容易な構造

## 4. 制約事項

### 4.1 技術的制約
- Flutter for Windows を使用
- Windows 10以降をサポート対象とする
- ローカルストレージにデータを保存（クラウド同期は不要）

### 4.2 機能的制約
- ストップウォッチの最大数は10個
- ストップウォッチの最小数は2個
- 自動停止時刻の最大数は5個
- システムトレイ機能は実装しない
- 自動開始機能は実装しない

## 5. 用語定義

| 用語 | 定義 |
|------|------|
| ストップウォッチ | 作業時間を計測する単位。名称、計測時間、操作ボタンを持つ |
| 単一計測モード | 1つのストップウォッチのみ計測可能なモード |
| 複数同時計測モード | 複数のストップウォッチを同時に計測可能なモード |
| 自動停止時刻 | 設定した時刻に到達すると自動的に計測を停止する機能 |
| HH:MM形式 | 時:分で時間を表示する形式（例：01:30） |
| 0.25単位表記 | 時間を小数で表現し、15分単位（0.25時間）で表示する形式 |

## 6. 想定ユースケース

### 6.1 業務時間の記録
複数のプロジェクトや作業に従事するユーザーが、各作業にかかった時間を個別に計測・記録する。

### 6.2 タスク管理
1日の中で複数のタスクを切り替えながら作業するユーザーが、各タスクの所要時間を把握する。

### 6.3 休憩時間の自動除外
昼休みなどの休憩時間を自動停止時刻として設定し、作業時間から自動的に除外する。

## 7. 今後の拡張可能性

以下の機能は初期リリースには含まれないが、将来的な拡張として検討可能：

- 計測履歴のエクスポート機能（CSV、Excel）
- 日次・週次・月次のレポート機能
- タグやカテゴリによるストップウォッチの分類
- 目標時間の設定とアラート機能
- ダークモード対応
- 他プラットフォーム（macOS、Linux）への展開